/**

JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2012 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See LICENSE.markdown.

Usage:
   zip = new JSZip();
   zip.file("hello.txt", "Hello, World!").file("tempfile", "nothing");
   zip.folder("images").file("smile.gif", base64Data, {base64: true});
   zip.file("Xmas.txt", "Ho ho ho !", {date : new Date("December 25, 2007 00:00:01")});
   zip.remove("tempfile");

   base64zip = zip.generate();

**/
var JSZip=function(r,t){this.files={},this.root="",r&&this.load(r,t)};JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},JSZip.defaults={base64:!1,binary:!1,dir:!1,date:null,compression:null},JSZip.support={arraybuffer:function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array}(),nodebuffer:function(){return"undefined"!=typeof Buffer}(),uint8array:function(){return"undefined"!=typeof Uint8Array}(),blob:function(){if("undefined"==typeof ArrayBuffer)return!1;var r=new ArrayBuffer(0);try{return 0===new Blob([r],{type:"application/zip"}).size}catch(t){}try{var e=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,n=new e;return n.append(r),0===n.getBlob("application/zip").size}catch(t){}return!1}()},JSZip.prototype=function(){var r,t;JSZip.support.uint8array&&"function"==typeof TextEncoder&&"function"==typeof TextDecoder&&(r=new TextEncoder("utf-8"),t=new TextDecoder("utf-8"));var e=function(r){if(r._data instanceof JSZip.CompressedObject&&(r._data=r._data.getContent(),r.options.binary=!0,r.options.base64=!1,"uint8array"===JSZip.utils.getTypeOf(r._data))){var t=r._data;r._data=new Uint8Array(t.length),0!==t.length&&r._data.set(t,0)}return r._data},n=function(t){var n=e(t),i=JSZip.utils.getTypeOf(n);if("string"===i){if(!t.options.binary){if(r)return r.encode(n);if(JSZip.support.nodebuffer)return new Buffer(n,"utf-8")}return t.asBinary()}return n},i=function(r){var t=e(this);return null===t||t===void 0?"":(this.options.base64&&(t=JSZip.base64.decode(t)),t=r&&this.options.binary?JSZip.prototype.utf8decode(t):JSZip.utils.transformTo("string",t),r||this.options.binary||(t=JSZip.prototype.utf8encode(t)),t)},o=function(r,t,e){this.name=r,this._data=t,this.options=e};o.prototype={asText:function(){return i.call(this,!0)},asBinary:function(){return i.call(this,!1)},asNodeBuffer:function(){var r=n(this);return JSZip.utils.transformTo("nodebuffer",r)},asUint8Array:function(){var r=n(this);return JSZip.utils.transformTo("uint8array",r)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var a=function(r,t){var e,n="";for(e=0;t>e;e++)n+=String.fromCharCode(255&r),r>>>=8;return n},s=function(){var r,t,e={};for(r=0;arguments.length>r;r++)for(t in arguments[r])arguments[r].hasOwnProperty(t)&&e[t]===void 0&&(e[t]=arguments[r][t]);return e},u=function(r){return r=r||{},r.base64===!0&&null==r.binary&&(r.binary=!0),r=s(r,JSZip.defaults),r.date=r.date||new Date,null!==r.compression&&(r.compression=r.compression.toUpperCase()),r},f=function(r,t,e){var n=p(r),i=JSZip.utils.getTypeOf(t);if(n&&c.call(this,n),e=u(e),e.dir||null===t||t===void 0)e.base64=!1,e.binary=!1,t=null;else if("string"===i)e.binary&&!e.base64&&e.optimizedBinaryString!==!0&&(t=JSZip.utils.string2binary(t));else{if(e.base64=!1,e.binary=!0,!(i||t instanceof JSZip.CompressedObject))throw Error("The data of '"+r+"' is in an unsupported format !");"arraybuffer"===i&&(t=JSZip.utils.transformTo("uint8array",t))}var a=new o(r,t,e);return this.files[r]=a,a},p=function(r){"/"==r.slice(-1)&&(r=r.substring(0,r.length-1));var t=r.lastIndexOf("/");return t>0?r.substring(0,t):""},c=function(r){return"/"!=r.slice(-1)&&(r+="/"),this.files[r]||f.call(this,r,null,{dir:!0}),this.files[r]},l=function(r,t){var e,i=new JSZip.CompressedObject;return r._data instanceof JSZip.CompressedObject?(i.uncompressedSize=r._data.uncompressedSize,i.crc32=r._data.crc32,0===i.uncompressedSize||r.options.dir?(t=JSZip.compressions.STORE,i.compressedContent="",i.crc32=0):r._data.compressionMethod===t.magic?i.compressedContent=r._data.getCompressedContent():(e=r._data.getContent(),i.compressedContent=t.compress(JSZip.utils.transformTo(t.compressInputType,e)))):(e=n(r),(!e||0===e.length||r.options.dir)&&(t=JSZip.compressions.STORE,e=""),i.uncompressedSize=e.length,i.crc32=this.crc32(e),i.compressedContent=t.compress(JSZip.utils.transformTo(t.compressInputType,e))),i.compressedSize=i.compressedContent.length,i.compressionMethod=t.magic,i},d=function(r,t,e,n){var i,o,s=(e.compressedContent,this.utf8encode(t.name)),u=s!==t.name,f=t.options;i=f.date.getHours(),i<<=6,i|=f.date.getMinutes(),i<<=5,i|=f.date.getSeconds()/2,o=f.date.getFullYear()-1980,o<<=4,o|=f.date.getMonth()+1,o<<=5,o|=f.date.getDate();var p="";p+="\n\0",p+=u?"\0\b":"\0\0",p+=e.compressionMethod,p+=a(i,2),p+=a(o,2),p+=a(e.crc32,4),p+=a(e.compressedSize,4),p+=a(e.uncompressedSize,4),p+=a(s.length,2),p+="\0\0";var c=JSZip.signature.LOCAL_FILE_HEADER+p+s,l=JSZip.signature.CENTRAL_FILE_HEADER+"\0"+p+"\0\0"+"\0\0"+"\0\0"+(t.options.dir===!0?"\0\0\0":"\0\0\0\0")+a(n,4)+s;return{fileRecord:c,dirRecord:l,compressedObject:e}},h=function(){this.data=[]};h.prototype={append:function(r){r=JSZip.utils.transformTo("string",r),this.data.push(r)},finalize:function(){return this.data.join("")}};var y=function(r){this.data=new Uint8Array(r),this.index=0};return y.prototype={append:function(r){0!==r.length&&(r=JSZip.utils.transformTo("uint8array",r),this.data.set(r,this.index),this.index+=r.length)},finalize:function(){return this.data}},{load:function(){throw Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(r){var t,e,n,i,a=[];for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],i=new o(n.name,n._data,s(n.options)),e=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&r(e,i)&&a.push(i));return a},file:function(r,t,e){if(1===arguments.length){if(JSZip.utils.isRegExp(r)){var n=r;return this.filter(function(r,t){return!t.options.dir&&n.test(r)})}return this.filter(function(t,e){return!e.options.dir&&t===r})[0]||null}return r=this.root+r,f.call(this,r,t,e),this},folder:function(r){if(!r)return this;if(JSZip.utils.isRegExp(r))return this.filter(function(t,e){return e.options.dir&&r.test(t)});var t=this.root+r,e=c.call(this,t),n=this.clone();return n.root=e.name,n},remove:function(r){r=this.root+r;var t=this.files[r];if(t||("/"!=r.slice(-1)&&(r+="/"),t=this.files[r]),t)if(t.options.dir)for(var e=this.filter(function(t,e){return e.name.slice(0,r.length)===r}),n=0;e.length>n;n++)delete this.files[e[n].name];else delete this.files[r];return this},generate:function(r){r=s(r||{},{base64:!0,compression:"STORE",type:"base64"}),JSZip.utils.checkSupport(r.type);var t,e,n=[],i=0,o=0;for(var u in this.files)if(this.files.hasOwnProperty(u)){var f=this.files[u],p=f.options.compression||r.compression.toUpperCase(),c=JSZip.compressions[p];if(!c)throw Error(p+" is not a valid compression method !");var g=l.call(this,f,c),b=d.call(this,u,f,g,i);i+=b.fileRecord.length+g.compressedSize,o+=b.dirRecord.length,n.push(b)}var S="";switch(S=JSZip.signature.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+a(n.length,2)+a(n.length,2)+a(o,4)+a(i,4)+"\0\0",r.type.toLowerCase()){case"uint8array":case"arraybuffer":case"blob":case"nodebuffer":t=new y(i+o+S.length);break;default:t=new h(i+o+S.length)}for(e=0;n.length>e;e++)t.append(n[e].fileRecord),t.append(n[e].compressedObject.compressedContent);for(e=0;n.length>e;e++)t.append(n[e].dirRecord);t.append(S);var m=t.finalize();switch(r.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return JSZip.utils.transformTo(r.type.toLowerCase(),m);case"blob":return JSZip.utils.arrayBuffer2Blob(JSZip.utils.transformTo("arraybuffer",m));case"base64":return r.base64?JSZip.base64.encode(m):m;default:return m}},crc32:function(r,t){if(r===void 0||!r.length)return 0;var e="string"!==JSZip.utils.getTypeOf(r),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t===void 0&&(t=0);var i=0,o=0,a=0;t=-1^t;for(var s=0,u=r.length;u>s;s++)a=e?r[s]:r.charCodeAt(s),o=255&(t^a),i=n[o],t=t>>>8^i;return-1^t},clone:function(){var r=new JSZip;for(var t in this)"function"!=typeof this[t]&&(r[t]=this[t]);return r},utf8encode:function(t){if(r){var e=r.encode(t);return JSZip.utils.transformTo("string",e)}if(JSZip.support.nodebuffer)return JSZip.utils.transformTo("string",new Buffer(t,"utf-8"));for(var n=[],i=0,o=0;t.length>o;o++){var a=t.charCodeAt(o);128>a?n[i++]=String.fromCharCode(a):a>127&&2048>a?(n[i++]=String.fromCharCode(192|a>>6),n[i++]=String.fromCharCode(128|63&a)):(n[i++]=String.fromCharCode(224|a>>12),n[i++]=String.fromCharCode(128|63&a>>6),n[i++]=String.fromCharCode(128|63&a))}return n.join("")},utf8decode:function(r){var e=[],n=0,i=JSZip.utils.getTypeOf(r),o="string"!==i,a=0,s=0,u=0,f=0;if(t)return t.decode(JSZip.utils.transformTo("uint8array",r));if(JSZip.support.nodebuffer)return JSZip.utils.transformTo("nodebuffer",r).toString("utf-8");for(;r.length>a;)s=o?r[a]:r.charCodeAt(a),128>s?(e[n++]=String.fromCharCode(s),a++):s>191&&224>s?(u=o?r[a+1]:r.charCodeAt(a+1),e[n++]=String.fromCharCode((31&s)<<6|63&u),a+=2):(u=o?r[a+1]:r.charCodeAt(a+1),f=o?r[a+2]:r.charCodeAt(a+2),e[n++]=String.fromCharCode((15&s)<<12|(63&u)<<6|63&f),a+=3);return e.join("")}}}(),JSZip.compressions={STORE:{magic:"\0\0",compress:function(r){return r},uncompress:function(r){return r},compressInputType:null,uncompressInputType:null}},function(){function r(r){return r}function t(r,t){for(var e=0;r.length>e;++e)t[e]=255&r.charCodeAt(e);return t}function e(r){var t=65536,e=[],n=r.length,i=JSZip.utils.getTypeOf(r),o=0,a=!0;try{switch(i){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,new Buffer(0))}}catch(s){a=!1}if(!a){for(var u="",f=0;r.length>f;f++)u+=String.fromCharCode(r[f]);return u}for(;n>o&&t>1;)try{"array"===i||"nodebuffer"===i?e.push(String.fromCharCode.apply(null,r.slice(o,Math.min(o+t,n)))):e.push(String.fromCharCode.apply(null,r.subarray(o,Math.min(o+t,n)))),o+=t}catch(s){t=Math.floor(t/2)}return e.join("")}function n(r,t){for(var e=0;r.length>e;e++)t[e]=r[e];return t}JSZip.utils={string2binary:function(r){for(var t="",e=0;r.length>e;e++)t+=String.fromCharCode(255&r.charCodeAt(e));return t},string2Uint8Array:function(r){return JSZip.utils.transformTo("uint8array",r)},uint8Array2String:function(r){return JSZip.utils.transformTo("string",r)},arrayBuffer2Blob:function(r){JSZip.utils.checkSupport("blob");try{return new Blob([r],{type:"application/zip"})}catch(t){}try{var e=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,n=new e;return n.append(r),n.getBlob("application/zip")}catch(t){}throw Error("Bug : can't construct the Blob.")},string2Blob:function(r){var t=JSZip.utils.transformTo("arraybuffer",r);return JSZip.utils.arrayBuffer2Blob(t)}};var i={};i.string={string:r,array:function(r){return t(r,Array(r.length))},arraybuffer:function(r){return i.string.uint8array(r).buffer},uint8array:function(r){return t(r,new Uint8Array(r.length))},nodebuffer:function(r){return t(r,new Buffer(r.length))}},i.array={string:e,array:r,arraybuffer:function(r){return new Uint8Array(r).buffer},uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return new Buffer(r)}},i.arraybuffer={string:function(r){return e(new Uint8Array(r))},array:function(r){return n(new Uint8Array(r),Array(r.byteLength))},arraybuffer:r,uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return new Buffer(new Uint8Array(r))}},i.uint8array={string:e,array:function(r){return n(r,Array(r.length))},arraybuffer:function(r){return r.buffer},uint8array:r,nodebuffer:function(r){return new Buffer(r)}},i.nodebuffer={string:e,array:function(r){return n(r,Array(r.length))},arraybuffer:function(r){return i.nodebuffer.uint8array(r).buffer},uint8array:function(r){return n(r,new Uint8Array(r.length))},nodebuffer:r},JSZip.utils.transformTo=function(r,t){if(t||(t=""),!r)return t;JSZip.utils.checkSupport(r);var e=JSZip.utils.getTypeOf(t),n=i[e][r](t);return n},JSZip.utils.getTypeOf=function(r){return"string"==typeof r?"string":"[object Array]"===Object.prototype.toString.call(r)?"array":JSZip.support.nodebuffer&&Buffer.isBuffer(r)?"nodebuffer":JSZip.support.uint8array&&r instanceof Uint8Array?"uint8array":JSZip.support.arraybuffer&&r instanceof ArrayBuffer?"arraybuffer":void 0},JSZip.utils.isRegExp=function(r){return"[object RegExp]"===Object.prototype.toString.call(r)},JSZip.utils.checkSupport=function(r){var t=!0;switch(r.toLowerCase()){case"uint8array":t=JSZip.support.uint8array;break;case"arraybuffer":t=JSZip.support.arraybuffer;break;case"nodebuffer":t=JSZip.support.nodebuffer;break;case"blob":t=JSZip.support.blob}if(!t)throw Error(r+" is not supported by this browser")}}(),function(){JSZip.CompressedObject=function(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null},JSZip.CompressedObject.prototype={getContent:function(){return null},getCompressedContent:function(){return null}}}(),JSZip.base64=function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){for(var e,n,i,o,a,s,u,f="",p=0;t.length>p;)e=t.charCodeAt(p++),n=t.charCodeAt(p++),i=t.charCodeAt(p++),o=e>>2,a=(3&e)<<4|n>>4,s=(15&n)<<2|i>>6,u=63&i,isNaN(n)?s=u=64:isNaN(i)&&(u=64),f=f+r.charAt(o)+r.charAt(a)+r.charAt(s)+r.charAt(u);return f},decode:function(t){var e,n,i,o,a,s,u,f="",p=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");t.length>p;)o=r.indexOf(t.charAt(p++)),a=r.indexOf(t.charAt(p++)),s=r.indexOf(t.charAt(p++)),u=r.indexOf(t.charAt(p++)),e=o<<2|a>>4,n=(15&a)<<4|s>>2,i=(3&s)<<6|u,f+=String.fromCharCode(e),64!=s&&(f+=String.fromCharCode(n)),64!=u&&(f+=String.fromCharCode(i));return f}}}();